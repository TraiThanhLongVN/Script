
--// Xóa GUI cũ và reset _G
for _, gui in pairs(game:GetService("Players").LocalPlayer.PlayerGui:GetChildren()) do
	if gui.Name == "AutoSwingGUI" then
		gui:Destroy()
	end
end
_G.AutoSwing = nil
_G.HitMultiplier = nil
_G.AutoBanjo = nil -- Khởi tạo biến toàn cục mới
_G.BanjoNote = 1
_G.BanjoMultiplier = 1

--// Cấu hình
local VERSION = "v1.4.0" -- Cập nhật version
local LANG = "vi" -- vi = Tiếng Việt, en = English
local guiVisible = true

-- Cấu hình tốc độ dễ dàng điều chỉnh
_G.SwingSpeedDelta = 0.49
local BANJO_WAIT_TIME = 0.5 -- Thời gian chờ giữa các lần đánh Banjo

-- Cấu hình Nhân Số Lần Đánh
local MAX_MULTIPLIER = 10
local MIN_MULTIPLIER = 1
local MAX_BANJO_NOTE = 5
local MIN_BANJO_NOTE = 1

--// Các Service Cần Thiết
local Players = game:GetService("Players")
local Workspace = game:GetService("Workspace")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local uis = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")

--// Hàm Raycast để tìm vị trí mục tiêu (Camera sight)
local function getHitPosition()
	local camera = Workspace.CurrentCamera
	local raycastParams = RaycastParams.new()
	local player = Players.LocalPlayer
	raycastParams.FilterDescendantsInstances = {player.Character}
	raycastParams.FilterType = Enum.RaycastFilterType.Exclude
	
	local raycastResult = Workspace:Raycast(camera.CFrame.Position, camera.CFrame.LookVector * 1000, raycastParams)
	
	if raycastResult then
		return raycastResult.Position
	else
		return camera.CFrame.Position + camera.CFrame.LookVector * 100
	end
end


--// GUI chính
local player = Players.LocalPlayer
local gui = Instance.new("ScreenGui", player:WaitForChild("PlayerGui"))
gui.Name = "AutoSwingGUI"
gui.ResetOnSpawn = false
gui.DisplayOrder = 999

-- Kích thước Frame chính được tăng lên để chứa Auto Banjo
local expandedSize = UDim2.new(0, 220, 0, 420) 
local collapsedSize = UDim2.new(0, 220, 0, 25)

-- Frame chính
local mainFrame = Instance.new("Frame", gui)
mainFrame.Size = expandedSize 
mainFrame.Position = UDim2.new(0.05, 0, 0.25, 0)
mainFrame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
Instance.new("UICorner", mainFrame).CornerRadius = UDim.new(0, 10)

-- Thanh kéo
local dragBar = Instance.new("Frame", mainFrame)
dragBar.Size = UDim2.new(1, 0, 0, 25)
dragBar.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
Instance.new("UICorner", dragBar).CornerRadius = UDim.new(0, 10)

local dragLabel = Instance.new("TextLabel", dragBar)
dragLabel.Size = UDim2.new(1, -30, 1, 0)
dragLabel.Position = UDim2.new(0, 5, 0, 0)
dragLabel.BackgroundTransparency = 1
dragLabel.Text = "🎯 Giao diện Auto Utility (v" .. VERSION .. ")"
dragLabel.Font = Enum.Font.SourceSansBold
dragLabel.TextSize = 16
dragLabel.TextColor3 = Color3.new(1, 1, 1)

-- 🔘 Nút đóng/mở
local closeBtn = Instance.new("TextButton", dragBar)
closeBtn.Size = UDim2.new(0, 25, 0, 25)
closeBtn.Position = UDim2.new(1, -25, 0, 0)
closeBtn.BackgroundColor3 = Color3.fromRGB(90, 90, 90)
closeBtn.Text = "—"
closeBtn.TextColor3 = Color3.new(1, 1, 1)
closeBtn.Font = Enum.Font.SourceSansBold
closeBtn.TextSize = 18
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 8)

-- Kéo được
local dragging, dragInput, dragStart, startPos
local function update(input)
	local delta = input.Position - dragStart
	mainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X,
		startPos.Y.Scale, startPos.Y.Offset + delta.Y)
end
dragBar.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		dragging = true
		dragStart = input.Position
		startPos = mainFrame.Position
		input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then dragging = false end
		end)
	end
end)
dragBar.InputChanged:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
		dragInput = input
	end
end)
uis.InputChanged:Connect(function(input)
	if input == dragInput and dragging then update(input) end
end)

-- Biến
_G.AutoSwing = false
_G.AutoBanjo = false -- Biến trạng thái mới
_G.SwingSpeedDelta = tonumber(_G.SwingSpeedDelta) or 0.49
local sliderValue = 0.5
local hitMultiplierValue = 1
local banjoNoteValue = _G.BanjoNote
local banjoMultiplierValue = _G.BanjoMultiplier


---------------------------------------------------
--// PHẦN AUTO SWING (Được dời xuống 35)
---------------------------------------------------

-- Khung Auto Swing (35 - 170)
local swingFrame = Instance.new("Frame", mainFrame)
swingFrame.Size = UDim2.new(1, -20, 0, 170)
swingFrame.Position = UDim2.new(0, 10, 0, 35)
swingFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
Instance.new("UICorner", swingFrame).CornerRadius = UDim.new(0, 8)

local swingTitle = Instance.new("TextLabel", swingFrame)
swingTitle.Size = UDim2.new(1, 0, 0, 20)
swingTitle.Position = UDim2.new(0, 0, 0, 5)
swingTitle.BackgroundTransparency = 1
swingTitle.Text = "⚔️ Auto Swing / Melee"
swingTitle.Font = Enum.Font.SourceSansBold
swingTitle.TextSize = 17
swingTitle.TextColor3 = Color3.new(1, 1, 1)

-- Nút AutoSwing (Vị trí Y: 30 trong swingFrame)
local autoSwingBtn = Instance.new("TextButton", swingFrame)
autoSwingBtn.Size = UDim2.new(1, -20, 0, 30)
autoSwingBtn.Position = UDim2.new(0, 10, 0, 30)
autoSwingBtn.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
autoSwingBtn.Text = "AutoSwing: TẮT"
autoSwingBtn.TextColor3 = Color3.new(1, 1, 1)
autoSwingBtn.Font = Enum.Font.SourceSansBold
autoSwingBtn.TextSize = 18
Instance.new("UICorner", autoSwingBtn).CornerRadius = UDim.new(0, 6)

-- Slider (Vị trí Y: 65 trong swingFrame)
local sliderFrame = Instance.new("Frame", swingFrame)
sliderFrame.Size = UDim2.new(1, -20, 0, 15)
sliderFrame.Position = UDim2.new(0, 10, 0, 65)
sliderFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
Instance.new("UICorner", sliderFrame).CornerRadius = UDim.new(0, 6)

local sliderFill = Instance.new("Frame", sliderFrame)
local initialSliderValue = 0.5
sliderFill.Size = UDim2.new(initialSliderValue, 0, 1, 0)
sliderFill.BackgroundColor3 = Color3.fromRGB(0, 170, 255)
Instance.new("UICorner", sliderFill).CornerRadius = UDim.new(0, 6)

-- Nhãn tốc độ (Vị trí Y: 85 trong swingFrame)
local speedLabel = Instance.new("TextLabel", swingFrame)
local initialWaitTime = 0.5 - (initialSliderValue * _G.SwingSpeedDelta)
speedLabel.Size = UDim2.new(1, 0, 0, 15)
speedLabel.Position = UDim2.new(0, 0, 0, 85)
speedLabel.BackgroundTransparency = 1
speedLabel.TextColor3 = Color3.new(1, 1, 1)
speedLabel.Font = Enum.Font.SourceSans
speedLabel.TextSize = 15
speedLabel.Text = string.format("Tốc độ: 50%% (%.2fs/hit)", initialWaitTime)

-- TEXTBOX NHÂN ĐÁNH (Vị trí Y: 105 trong swingFrame)
local multiplierFrame = Instance.new("Frame", swingFrame)
multiplierFrame.Size = UDim2.new(1, -20, 0, 25)
multiplierFrame.Position = UDim2.new(0, 10, 0, 105)
multiplierFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
Instance.new("UICorner", multiplierFrame).CornerRadius = UDim.new(0, 6)

local multiplierLabel = Instance.new("TextLabel", multiplierFrame)
multiplierLabel.Size = UDim2.new(0.65, -5, 1, 0)
multiplierLabel.Position = UDim2.new(0, 5, 0, 0)
multiplierLabel.BackgroundTransparency = 1
multiplierLabel.Text = string.format("Nhân Đánh (%d - %d):", MIN_MULTIPLIER, MAX_MULTIPLIER)
multiplierLabel.Font = Enum.Font.SourceSansBold
multiplierLabel.TextSize = 15
multiplierLabel.TextColor3 = Color3.new(1, 1, 1)
multiplierLabel.TextXAlignment = Enum.TextXAlignment.Left

local multiplierInput = Instance.new("TextBox", multiplierFrame)
multiplierInput.Size = UDim2.new(0.35, -5, 1, -4)
multiplierInput.Position = UDim2.new(0.65, 0, 0, 2)
multiplierInput.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
multiplierInput.Text = "1"
multiplierInput.Font = Enum.Font.SourceSansBold
multiplierInput.TextSize = 15
multiplierInput.TextColor3 = Color3.new(1, 1, 1)
multiplierInput.PlaceholderText = "Số..."
multiplierInput.TextYAlignment = Enum.TextYAlignment.Center
multiplierInput.TextXAlignment = Enum.TextXAlignment.Center
Instance.new("UICorner", multiplierInput).CornerRadius = UDim.new(0, 5)

-- LOGIC TEXTBOX NHÂN ĐÁNH (SWING)
multiplierInput.FocusLost:Connect(function(enterPressed, inputThatCausedFocusLoss)
	local text = multiplierInput.Text
	local num = tonumber(text)

	if num and num >= MIN_MULTIPLIER and num <= MAX_MULTIPLIER and num == math.floor(num) then
		hitMultiplierValue = num
		multiplierInput.Text = tostring(hitMultiplierValue)
	else
		hitMultiplierValue = math.clamp(math.floor(num or MIN_MULTIPLIER), MIN_MULTIPLIER, MAX_MULTIPLIER)
		multiplierInput.Text = tostring(hitMultiplierValue)
		
		local oldColor = multiplierInput.BackgroundColor3
		multiplierInput.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
		task.wait(0.5)
		multiplierInput.BackgroundColor3 = oldColor
	end
end)


---------------------------------------------------
--// PHẦN AUTO BANJO (DÀNH CHO DEAD RAIL)
---------------------------------------------------

-- Khung Auto Banjo (Vị trí Y: 215)
local banjoFrame = Instance.new("Frame", mainFrame)
banjoFrame.Size = UDim2.new(1, -20, 0, 170) -- Cùng kích thước với swingFrame
banjoFrame.Position = UDim2.new(0, 10, 0, 215)
banjoFrame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
Instance.new("UICorner", banjoFrame).CornerRadius = UDim.new(0, 8)

local banjoTitle = Instance.new("TextLabel", banjoFrame)
banjoTitle.Size = UDim2.new(1, 0, 0, 20)
banjoTitle.Position = UDim2.new(0, 0, 0, 5)
banjoTitle.BackgroundTransparency = 1
banjoTitle.Text = "🎶 Auto Banjo (Dead Rail)"
banjoTitle.Font = Enum.Font.SourceSansBold
banjoTitle.TextSize = 17
banjoTitle.TextColor3 = Color3.new(1, 1, 1)

-- Nút AutoBanjo (Vị trí Y: 30 trong banjoFrame)
local autoBanjoBtn = Instance.new("TextButton", banjoFrame)
autoBanjoBtn.Size = UDim2.new(1, -20, 0, 30)
autoBanjoBtn.Position = UDim2.new(0, 10, 0, 30)
autoBanjoBtn.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
autoBanjoBtn.Text = "AutoBanjo: TẮT"
autoBanjoBtn.TextColor3 = Color3.new(1, 1, 1)
autoBanjoBtn.Font = Enum.Font.SourceSansBold
autoBanjoBtn.TextSize = 18
Instance.new("UICorner", autoBanjoBtn).CornerRadius = UDim.new(0, 6)

-- TEXTBOX CHỌN NỐT (Vị trí Y: 65 trong banjoFrame)
local noteFrame = Instance.new("Frame", banjoFrame)
noteFrame.Size = UDim2.new(1, -20, 0, 25)
noteFrame.Position = UDim2.new(0, 10, 0, 65)
noteFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
Instance.new("UICorner", noteFrame).CornerRadius = UDim.new(0, 6)

local noteLabel = Instance.new("TextLabel", noteFrame)
noteLabel.Size = UDim2.new(0.65, -5, 1, 0)
noteLabel.Position = UDim2.new(0, 5, 0, 0)
noteLabel.BackgroundTransparency = 1
noteLabel.Text = string.format("Nốt Banjo (%d - %d):", MIN_BANJO_NOTE, MAX_BANJO_NOTE)
noteLabel.Font = Enum.Font.SourceSansBold
noteLabel.TextSize = 15
noteLabel.TextColor3 = Color3.new(1, 1, 1)
noteLabel.TextXAlignment = Enum.TextXAlignment.Left

local noteInput = Instance.new("TextBox", noteFrame)
noteInput.Size = UDim2.new(0.35, -5, 1, -4)
noteInput.Position = UDim2.new(0.65, 0, 0, 2)
noteInput.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
noteInput.Text = tostring(banjoNoteValue)
noteInput.Font = Enum.Font.SourceSansBold
noteInput.TextSize = 15
noteInput.TextColor3 = Color3.new(1, 1, 1)
noteInput.PlaceholderText = "Nốt..."
noteInput.TextYAlignment = Enum.TextYAlignment.Center
noteInput.TextXAlignment = Enum.TextXAlignment.Center
Instance.new("UICorner", noteInput).CornerRadius = UDim.new(0, 5)

-- TEXTBOX NHÂN ĐÁNH BANJO (Vị trí Y: 100 trong banjoFrame)
local banjoMultiplierFrame = Instance.new("Frame", banjoFrame)
banjoMultiplierFrame.Size = UDim2.new(1, -20, 0, 25)
banjoMultiplierFrame.Position = UDim2.new(0, 10, 0, 100)
banjoMultiplierFrame.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
Instance.new("UICorner", banjoMultiplierFrame).CornerRadius = UDim.new(0, 6)

local banjoMultiplierLabel = Instance.new("TextLabel", banjoMultiplierFrame)
banjoMultiplierLabel.Size = UDim2.new(0.65, -5, 1, 0)
banjoMultiplierLabel.Position = UDim2.new(0, 5, 0, 0)
banjoMultiplierLabel.BackgroundTransparency = 1
banjoMultiplierLabel.Text = string.format("Nhân Đánh Banjo (%d - %d):", MIN_MULTIPLIER, MAX_MULTIPLIER)
banjoMultiplierLabel.Font = Enum.Font.SourceSansBold
banjoMultiplierLabel.TextSize = 15
banjoMultiplierLabel.TextColor3 = Color3.new(1, 1, 1)
banjoMultiplierLabel.TextXAlignment = Enum.TextXAlignment.Left

local banjoMultiplierInput = Instance.new("TextBox", banjoMultiplierFrame)
banjoMultiplierInput.Size = UDim2.new(0.35, -5, 1, -4)
banjoMultiplierInput.Position = UDim2.new(0.65, 0, 0, 2)
banjoMultiplierInput.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
banjoMultiplierInput.Text = tostring(banjoMultiplierValue)
banjoMultiplierInput.Font = Enum.Font.SourceSansBold
banjoMultiplierInput.TextSize = 15
banjoMultiplierInput.TextColor3 = Color3.new(1, 1, 1)
banjoMultiplierInput.PlaceholderText = "Số..."
banjoMultiplierInput.TextYAlignment = Enum.TextYAlignment.Center
banjoMultiplierInput.TextXAlignment = Enum.TextXAlignment.Center
Instance.new("UICorner", banjoMultiplierInput).CornerRadius = UDim.new(0, 5)

-- Nhãn tốc độ Banjo
local banjoSpeedLabel = Instance.new("TextLabel", banjoFrame)
banjoSpeedLabel.Size = UDim2.new(1, 0, 0, 15)
banjoSpeedLabel.Position = UDim2.new(0, 0, 0, 130)
banjoSpeedLabel.BackgroundTransparency = 1
banjoSpeedLabel.TextColor3 = Color3.new(1, 1, 1)
banjoSpeedLabel.Font = Enum.Font.SourceSans
banjoSpeedLabel.TextSize = 15
banjoSpeedLabel.Text = string.format("Tốc độ Banjo: %.2fs/hit", BANJO_WAIT_TIME)


-- LOGIC TEXTBOX CHỌN NỐT
noteInput.FocusLost:Connect(function(enterPressed, inputThatCausedFocusLoss)
	local text = noteInput.Text
	local num = tonumber(text)

	if num and num >= MIN_BANJO_NOTE and num <= MAX_BANJO_NOTE and num == math.floor(num) then
		banjoNoteValue = num
		noteInput.Text = tostring(banjoNoteValue)
	else
		banjoNoteValue = math.clamp(math.floor(num or MIN_BANJO_NOTE), MIN_BANJO_NOTE, MAX_BANJO_NOTE)
		noteInput.Text = tostring(banjoNoteValue)
		
		local oldColor = noteInput.BackgroundColor3
		noteInput.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
		task.wait(0.5)
		noteInput.BackgroundColor3 = oldColor
	end
end)

-- LOGIC TEXTBOX NHÂN ĐÁNH BANJO
banjoMultiplierInput.FocusLost:Connect(function(enterPressed, inputThatCausedFocusLoss)
	local text = banjoMultiplierInput.Text
	local num = tonumber(text)

	if num and num >= MIN_MULTIPLIER and num <= MAX_MULTIPLIER and num == math.floor(num) then
		banjoMultiplierValue = num
		banjoMultiplierInput.Text = tostring(banjoMultiplierValue)
	else
		banjoMultiplierValue = math.clamp(math.floor(num or MIN_MULTIPLIER), MIN_MULTIPLIER, MAX_MULTIPLIER)
		banjoMultiplierInput.Text = tostring(banjoMultiplierValue)
		
		local oldColor = banjoMultiplierInput.BackgroundColor3
		banjoMultiplierInput.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
		task.wait(0.5)
		banjoMultiplierInput.BackgroundColor3 = oldColor
	end
end)

---------------------------------------------------
--// PHẦN CHUNG/LOGIC CUỐI
---------------------------------------------------

-- Galaxy Credit (Vị trí Y: 395)
local credit = Instance.new("TextLabel", mainFrame)
credit.Size = UDim2.new(1, 0, 0, 20)
credit.Position = UDim2.new(0, 0, 0, 385)
credit.BackgroundTransparency = 1
credit.Font = Enum.Font.SourceSansBold
credit.TextSize = 15
credit.Text = "Made by Thanh Long x GPT-5"
credit.TextStrokeTransparency = 0.2
credit.TextStrokeColor3 = Color3.fromRGB(200, 150, 255)
local gradient = Instance.new("UIGradient", credit)
gradient.Color = ColorSequence.new{
	ColorSequenceKeypoint.new(0, Color3.fromRGB(170, 90, 255)),
	ColorSequenceKeypoint.new(0.5, Color3.fromRGB(90, 200, 255)),
	ColorSequenceKeypoint.new(1, Color3.fromRGB(255, 100, 200))
}
task.spawn(function()
	while task.wait(0.1) do
		gradient.Rotation = (gradient.Rotation + 3) % 360
	end
end)


-- Nút đổi ngôn ngữ (Vị trí Y: 360)
local langBtn = Instance.new("TextButton", mainFrame)
langBtn.Size = UDim2.new(0.5, -15, 0, 20)
langBtn.Position = UDim2.new(0, 10, 0, 360)
langBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
langBtn.TextColor3 = Color3.new(1, 1, 1)
langBtn.Font = Enum.Font.SourceSansBold
langBtn.TextSize = 14
langBtn.Text = "🌐 Tiếng Việt"
Instance.new("UICorner", langBtn).CornerRadius = UDim.new(0, 6)

-- Phiên bản (Vị trí Y: 360)
local versionLabel = Instance.new("TextLabel", mainFrame)
versionLabel.Size = UDim2.new(0.5, -15, 0, 20)
versionLabel.Position = UDim2.new(0.5, 5, 0, 360)
versionLabel.BackgroundTransparency = 1
versionLabel.Font = Enum.Font.SourceSansItalic
versionLabel.TextColor3 = Color3.fromRGB(180, 180, 180)
versionLabel.TextSize = 14
versionLabel.Text = VERSION


-- AutoSwing loop
task.spawn(function()
	while task.wait() do
		if _G.AutoSwing then
			local waitTime = 0.5 - (sliderValue * _G.SwingSpeedDelta)
			local player = Players.LocalPlayer
			local char = player.Character or player.CharacterAdded:Wait()
			local weapon = char:FindFirstChildOfClass("Tool")

			if weapon then
				local hitPosition = getHitPosition()
				local args = { weapon, 0, hitPosition } 
				
				for i = 1, hitMultiplierValue do
					ReplicatedStorage
						:WaitForChild("Shared")
						:WaitForChild("Network")
						:WaitForChild("RemoteEvent")
						:WaitForChild("SwingMelee")
						:FireServer(unpack(args))
				end
			end
			task.wait(waitTime)
		end
	end
end)

-- AutoBanjo loop
task.spawn(function()
	while task.wait() do
		if _G.AutoBanjo then
			local player = Players.LocalPlayer
			local char = player.Character or player.CharacterAdded:Wait()
			-- Tìm công cụ Banjo (thường có tên là "Banjo" hoặc cần được điều chỉnh tùy game)
			local banjoTool = char:FindFirstChild("Banjo") 

			if banjoTool then
				local args = { banjoTool, banjoNoteValue } 
				
				-- Gửi yêu cầu đánh nốt lặp lại
				for i = 1, banjoMultiplierValue do
					ReplicatedStorage
						:WaitForChild("Shared")
						:WaitForChild("Network")
						:WaitForChild("RemoteEvent")
						:WaitForChild("PlayBanjo")
						:FireServer(unpack(args))
				end
			end
			task.wait(BANJO_WAIT_TIME)
		end
	end
end)


-- Toggle AutoSwing
autoSwingBtn.MouseButton1Click:Connect(function()
	_G.AutoSwing = not _G.AutoSwing
	if _G.AutoSwing then
		autoSwingBtn.Text = LANG == "vi" and "AutoSwing: BẬT" or "AutoSwing: ON"
		autoSwingBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
	else
		autoSwingBtn.Text = LANG == "vi" and "AutoSwing: TẮT" or "AutoSwing: OFF"
		autoSwingBtn.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
	end
end)

-- Toggle AutoBanjo
autoBanjoBtn.MouseButton1Click:Connect(function()
	_G.AutoBanjo = not _G.AutoBanjo
	if _G.AutoBanjo then
		autoBanjoBtn.Text = LANG == "vi" and "AutoBanjo: BẬT" or "AutoBanjo: ON"
		autoBanjoBtn.BackgroundColor3 = Color3.fromRGB(0, 170, 0)
	else
		autoBanjoBtn.Text = LANG == "vi" and "AutoBanjo: TẮT" or "AutoBanjo: OFF"
		autoBanjoBtn.BackgroundColor3 = Color3.fromRGB(170, 0, 0)
	end
end)


-- Slider logic (Giữ nguyên)
local draggingSlider = false
sliderFrame.InputBegan:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		draggingSlider = true
	end
end)
uis.InputEnded:Connect(function(input)
	if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
		draggingSlider = false
	end
end)
uis.InputChanged:Connect(function(input)
	if draggingSlider and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
		local relX = math.clamp((input.Position.X - sliderFrame.AbsolutePosition.X) / sliderFrame.AbsoluteSize.X, 0, 1)
		sliderValue = relX
		sliderFill.Size = UDim2.new(relX, 0, 1, 0)
		local waitTime = 0.5 - (sliderValue * _G.SwingSpeedDelta)
		if LANG == "vi" then
			speedLabel.Text = string.format("Tốc độ: %d%% (%.2fs/hit)", math.floor(sliderValue * 100), waitTime)
		else
			speedLabel.Text = string.format("Speed: %d%% (%.2fs/hit)", math.floor(sliderValue * 100), waitTime)
		end
	end
end)

-- Đổi ngôn ngữ
local function updateTexts(lang)
	if lang == "vi" then
		dragLabel.Text = "🎯 Giao diện Auto Utility (v" .. VERSION .. ")"
		swingTitle.Text = "⚔️ Auto Swing / Melee"
		autoSwingBtn.Text = _G.AutoSwing and "AutoSwing: BẬT" or "AutoSwing: TẮT"
		speedLabel.Text = string.format("Tốc độ: %d%% (%.2fs/hit)", math.floor(sliderValue * 100), 0.5 - sliderValue * _G.SwingSpeedDelta)
		multiplierLabel.Text = string.format("Nhân Đánh (%d - %d):", MIN_MULTIPLIER, MAX_MULTIPLIER)
		multiplierInput.PlaceholderText = "Số..."
		banjoTitle.Text = "🎶 Auto Banjo (Dead Rail)"
		autoBanjoBtn.Text = _G.AutoBanjo and "AutoBanjo: BẬT" or "AutoBanjo: TẮT"
		noteLabel.Text = string.format("Nốt Banjo (%d - %d):", MIN_BANJO_NOTE, MAX_BANJO_NOTE)
		noteInput.PlaceholderText = "Nốt..."
		banjoMultiplierLabel.Text = string.format("Nhân Đánh Banjo (%d - %d):", MIN_MULTIPLIER, MAX_MULTIPLIER)
		banjoMultiplierInput.PlaceholderText = "Số..."
		banjoSpeedLabel.Text = string.format("Tốc độ Banjo: %.2fs/hit", BANJO_WAIT_TIME)
		langBtn.Text = "🌐 Tiếng Việt"
	else
		dragLabel.Text = "🎯 Auto Utility GUI (v" .. VERSION .. ")"
		swingTitle.Text = "⚔️ Auto Swing / Melee"
		autoSwingBtn.Text = _G.AutoSwing and "AutoSwing: ON" or "AutoSwing: OFF"
		speedLabel.Text = string.format("Speed: %d%% (%.2fs/hit)", math.floor(sliderValue * 100), 0.5 - sliderValue * _G.SwingSpeedDelta)
		multiplierLabel.Text = string.format("Hit Multiplier (%d - %d):", MIN_MULTIPLIER, MAX_MULTIPLIER)
		multiplierInput.PlaceholderText = "Num..."
		banjoTitle.Text = "🎶 Auto Banjo (Dead Rail)"
		autoBanjoBtn.Text = _G.AutoBanjo and "AutoBanjo: ON" or "AutoBanjo: OFF"
		noteLabel.Text = string.format("Banjo Note (%d - %d):", MIN_BANJO_NOTE, MAX_BANJO_NOTE)
		noteInput.PlaceholderText = "Note..."
		banjoMultiplierLabel.Text = string.format("Banjo Multiplier (%d - %d):", MIN_MULTIPLIER, MAX_MULTIPLIER)
		banjoMultiplierInput.PlaceholderText = "Num..."
		banjoSpeedLabel.Text = string.format("Banjo Speed: %.2fs/hit", BANJO_WAIT_TIME)
		langBtn.Text = "🌐 English"
	end
end

updateTexts(LANG)

langBtn.MouseButton1Click:Connect(function()
	if LANG == "vi" then
		LANG = "en"
	else
		LANG = "vi"
	end
	updateTexts(LANG)
end)

-- Nút đóng/mở GUI (Cập nhật kích thước)
closeBtn.MouseButton1Click:Connect(function()
	guiVisible = not guiVisible
	
	for _, v in ipairs(mainFrame:GetChildren()) do
		if v:IsA("GuiObject") and v ~= dragBar then
			v.Visible = guiVisible
		end
	end

	local goal = { Size = guiVisible and expandedSize or collapsedSize }
	TweenService:Create(mainFrame, TweenInfo.new(0.25, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), goal):Play()

	closeBtn.Text = guiVisible and "—" or "+"
end)
